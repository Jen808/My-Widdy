<!DOCTYPE html>
<html>

<head>
    <title>Calendar: Impact</title>
    <link rel="stylesheet" href="../css/cal-color.css">
    <link rel="stylesheet" href="../css/my-widdy.css">


    <style>
        .calendar-page {
            background-color: #404040;
        }

        #calendar-page {
            color: #FF8D3A;
            font-weight: bold;
        }

        .cal2-image {
            width: 27.0625rem;
            height: 15.83294rem;
        }
    </style>
</head>

<body>

    <div class="sidebar">
        <div class="sidebar-header">
            <!-- <a href="#" target="_blank"> -->
            <img src="../src/logo.png" alt="Logo Image" class="logo-image">
            </a>
            <a href="#" id="logo-word">Widdy</a>
        </div>
        <div class="sidebar-menu">
            <nav>
                <ul>
                    <li class="myWiddy-page"><a href="#" id="myWiddy-page">My Widdy</a></li>
                    <li class="clock-page"><a href="#" id="clock-page">Clock</a></li>
                    <li class="calendar-page"><a href="#" id="calendar-page">Calendar</a></li>
                    <li class="toDoList-page"><a href="#" id="toDoList-page">To Do List</a></li>
                    <!-- <li class="weather-page"><a href="#" id="weather-page">Weather</a></li> -->
                </ul>
            </nav>
        </div>
    </div>
    <div class="main-content">
        <div class="head-container">
            <img src="../src/go-back-button.png" alt="Go Back" class="back-button">
            <div class="name">
                <a>Calendar: Impact</a>
            </div>
        </div>
        <div class="main-container">

            <img src="../src/calendar/cal2.png" alt="Calendar Image" class="cal2-image">

            <div class="setting">

                <div class="switch-container">
                    <a class="off">Off</a>
                    <label class="switch">
                        <input type="checkbox" id="toggleSwitchCal2">
                        <span class="slider"></span>
                    </label>
                    <a class="on">On</a>
                </div>

                <div class="color-setting">
                    <div class="color-header">Colors</div>
                    <div class="color-tiles">
                        <div class="color-buttons-white">
                            <button class="cal2-color-button" data-color-set="white">
                                <img src="../src/calendar/cal1-white.png" alt="white" width="30px" height="30px">
                            </button>
                            <button class="cal2-color-button" data-color-set="cmyk">
                                <img src="../src/calendar/cal1-cmyk.png" alt="cmyk" width="30px" height="30px">
                            </button>
                            <button class="cal2-color-button" data-color-set="li-pink">
                                <img src="../src/calendar/cal1-li-pink.png" alt="li-pink" width="30px" height="30px">
                            </button>
                            <button class="cal2-color-button" data-color-set="li-orange">
                                <img src="../src/calendar/cal1-li-orange.png" alt="li-orange" width="30px"
                                    height="30px">
                            </button>
                            <button class="cal2-color-button" data-color-set="li-green">
                                <img src="../src/calendar/cal1-li-green.png" alt="li-green" width="30px" height="30px">
                            </button>
                            <button class="cal2-color-button" data-color-set="li-mint">
                                <img src="../src/calendar/cal1-li-mint.png" alt="li-mint" width="30px" height="30px">
                            </button>
                            <button class="cal2-color-button" data-color-set="li-blue">
                                <img src="../src/calendar/cal1-li-blue.png" alt="li-blue" width="30px" height="30px">
                            </button>
                            <button class="cal2-color-button" data-color-set="li-purple">
                                <img src="../src/calendar/cal1-li-purple.png" alt="li-purple" width="30px"
                                    height="30px">
                            </button>
                        </div>
                        <div class="color-buttons-black">
                            <button class="cal2-color-button" data-color-set="black">
                                <img src="../src/calendar/cal1-black.png" alt="Black" width="30px" height="30px">
                            </button>
                            <button class="cal2-color-button" data-color-set="grey">
                                <img src="../src/calendar/cal1-grey.png" alt="grey" width="30px" height="30px">
                            </button>
                            <button class="cal2-color-button" data-color-set="pink">
                                <img src="../src/calendar/cal1-pink.png" alt="pink" width="30px" height="30px">
                            </button>
                            <button class="cal2-color-button" data-color-set="orange">
                                <img src="../src/calendar/cal1-orange.png" alt="orange" width="30px" height="30px">
                            </button>
                            <button class="cal2-color-button" data-color-set="green">
                                <img src="../src/calendar/cal1-green.png" alt="green" width="30px" height="30px">
                            </button>
                            <button class="cal2-color-button" data-color-set="mint">
                                <img src="../src/calendar/cal1-mint.png" alt="mint" width="30px" height="30px">
                            </button>
                            <button class="cal2-color-button" data-color-set="blue">
                                <img src="../src/calendar/cal1-blue.png" alt="blue" width="30px" height="30px">
                            </button>
                            <button class="cal2-color-button" data-color-set="purple">
                                <img src="../src/calendar/cal1-purple.png" alt="purple" width="30px" height="30px">
                            </button>
                        </div>
                    </div>
                </div>
                <div class="cal2-size-setting">
                    <div class="sizeheader">Size</div>
                    <div class="slider-container8">
                        <input type="range" id="sizeSliderCal2" min="1" max="100" value="50" class="custom-slider">
                        <span id="sliderValueCal2">50</span>
                    </div>
                </div>
                <button id="auth-button" class="link">Link to Google Account</button>
                <div id="auth-status"></div>
            </div>
        </div>
    </div>


    <script>
        const { ipcRenderer } = require('electron');


        document.getElementById('myWiddy-page').addEventListener('click', () => {
            window.location.href = 'my-widdy.html';
        });

        document.getElementById('logo-word').addEventListener('click', () => {
            window.location.href = 'my-widdy.html';
        });

        document.querySelector('.logo-image').addEventListener('click', (event) => {
            event.preventDefault();
            window.location.href = 'my-widdy.html';
        });

        document.querySelector('.back-button').addEventListener('click', () => {
            window.history.back();
        });

        document.getElementById('clock-page').addEventListener('click', () => {
            window.location.href = 'clock.html';
        });

        document.getElementById('calendar-page').addEventListener('click', () => {
            window.location.href = 'calendar.html';
        });

        document.getElementById('toDoList-page').addEventListener('click', () => {
            window.location.href = 'toDoList.html';
        });

        // document.getElementById('weather-page').addEventListener('click', () => {
        //     window.location.href = 'weather.html';
        // });




        // document.addEventListener('DOMContentLoaded', () => {
        //     const toggleSwitchCal2 = document.getElementById('toggleSwitchCal2');
        //     const sizeSliderCal2 = document.getElementById('sizeSliderCal2');
        //     const sliderValueCal2 = document.getElementById('sliderValueCal2');


        //     function synchronizeSettings() {
        //         const isCal2Open = localStorage.getItem('showCal2') === 'true';
        //         toggleSwitchCal2.checked = isCal2Open;

        //         if (isCal2Open) {
        //             const cal2Size = localStorage.getItem('cal2Size') || 50;
        //             sizeSliderCal2.value = cal2Size;
        //             sliderValueCal2.innerText = cal2Size;
        //             const cal2ColorSet = localStorage.getItem('cal2ColorSet') || 'li-grey';
        //             document.body.className = cal2ColorSet;
        //             document.querySelectorAll('.cal2-color-button').forEach(button => {
        //                 if (button.getAttribute('data-color-set') === cal2ColorSet) {
        //                     button.classList.add('selected');
        //                 } else {
        //                     button.classList.remove('selected');
        //                 }
        //             });
        //         }
        //     }

        //     synchronizeSettings();

        //     toggleSwitchCal2.addEventListener('change', () => {
        //         const isChecked = toggleSwitchCal2.checked;
        //         localStorage.setItem('showCal2', isChecked);
        //         ipcRenderer.send('cal2-status', { status: isChecked });

        //         if (isChecked) {
        //             synchronizeSettings();
        //         } else {
        //             sizeSliderCal2.value = 50;
        //             sliderValueCal2.innerText = 50;
        //             document.body.className = '';
        //             document.querySelectorAll('.cal2-color-button').forEach(button => {
        //                 button.classList.remove('selected');
        //             });
        //         }
        //     });

        //     sizeSliderCal2.addEventListener('input', () => {
        //         const newSize = sizeSliderCal2.value;
        //         sliderValueCal2.innerText = newSize;
        //         ipcRenderer.send('adjust-cal2-size', { size: newSize });
        //         localStorage.setItem('cal2Size', newSize);
        //     });

        //     document.querySelectorAll('.cal2-color-button').forEach(button => {
        //         button.addEventListener('click', () => {
        //             const colorSet = button.getAttribute('data-color-set');
        //             localStorage.setItem('cal2ColorSet', colorSet);
        //             ipcRenderer.send('change-cal2-color', colorSet);
        //             document.body.className = colorSet;
        //             document.querySelectorAll('.cal2-color-button').forEach(btn => {
        //                 if (btn.getAttribute('data-color-set') === colorSet) {
        //                     btn.classList.add('selected');
        //                 } else {
        //                     btn.classList.remove('selected');
        //                 }
        //             });
        //         });
        //     });

        //     window.addEventListener('storage', synchronizeSettings);
        // });

        // document.getElementById('auth-button').addEventListener('click', () => {
        //     window.open('http://localhost:3000/auth', '_blank');
        //     const authButton = document.getElementById('auth-button');
        //     const buttonText = authButton.innerText;
        //     if (buttonText === 'Link to Google Account') {
        //         ipcRenderer.send('auth-google');
        //     } else {
        //         ipcRenderer.send('logout-google');
        //     }
        // });

        // ipcRenderer.on('auth-status', (event, status) => {
        //     const authButton = document.getElementById('auth-button');
        //     const authStatus = document.getElementById('auth-status');

        //     if (status === 'linked') {
        //         authButton.innerText = 'Log out';
        //         authButton.classList.remove('link');
        //         authButton.classList.add('logout');
        //     } else {
        //         authButton.innerText = 'Link to Google Account';
        //         authButton.classList.remove('logout');
        //         authButton.classList.add('link');
        //     }
        // });

        // ipcRenderer.send('check-auth-status');


        document.addEventListener('DOMContentLoaded', () => {
            const toggleSwitchCal2 = document.getElementById('toggleSwitchCal2');
            const sizeSliderCal2 = document.getElementById('sizeSliderCal2');
            const sliderValueCal2 = document.getElementById('sliderValueCal2');
            const currentColorSetCal2 = localStorage.getItem('cal2ColorSet') || 'li-grey';
            const isCal2Open = localStorage.getItem('showCal2') === 'true';

            // Initialize the state of the toggle switch
            toggleSwitchCal2.checked = isCal2Open;

            // Initialize the size slider and its value display
            sizeSliderCal2.value = localStorage.getItem('cal2Size') || 50;
            sliderValueCal2.innerText = sizeSliderCal2.value;

            // Mark the selected color button
            markSelectedColor('cal2', currentColorSetCal2);

            // Handle toggle switch change
            toggleSwitchCal2.addEventListener('change', () => {
                const isChecked = toggleSwitchCal2.checked;
                localStorage.setItem('showCal2', isChecked);
                ipcRenderer.send('cal2-status', { status: isChecked });

                if (isChecked) {
                    // Set default settings when turned on
                    localStorage.setItem('cal2ColorSet', 'li-grey');
                    markSelectedColor('cal2', 'li-grey'); // Place color-check on li-grey
                    sizeSliderCal2.value = 50;
                    sliderValueCal2.innerText = 50;
                    localStorage.setItem('cal2Size', 50);
                    ipcRenderer.send('adjust-cal2-size', { size: 50 });
                } else {
                    // Reset settings when turned off
                    clearSelectedColor('cal2');
                    sizeSliderCal2.value = 50;
                    sliderValueCal2.innerText = 50;
                    ipcRenderer.send('adjust-cal2-size', { size: 50 });
                }
            });

            // Handle color button click
            document.querySelectorAll('.cal2-color-button').forEach(button => {
                button.addEventListener('click', () => {
                    const colorSet = button.getAttribute('data-color-set');
                    localStorage.setItem('cal2ColorSet', colorSet);
                    ipcRenderer.send('change-cal2-color', colorSet);
                    markSelectedColor('cal2', colorSet);
                });
            });

            // Handle size slider input
            sizeSliderCal2.addEventListener('input', () => {
                const newSize = sizeSliderCal2.value;
                sliderValueCal2.innerText = newSize;
                ipcRenderer.send('adjust-cal2-size', { size: newSize });
                localStorage.setItem('cal2Size', newSize);
            });

            // Handle authentication button click
            document.getElementById('auth-button').addEventListener('click', () => {
                const authButton = document.getElementById('auth-button');
                const buttonText = authButton.innerText;
                if (buttonText === 'Link to Google Account') {
                    ipcRenderer.send('auth-google');
                } else {
                    ipcRenderer.send('logout-google');
                }
            });

            // Update authentication status
            ipcRenderer.on('auth-status', (event, status) => {
                const authButton = document.getElementById('auth-button');
                const authStatus = document.getElementById('auth-status');

                if (status === 'linked') {
                    authButton.innerText = 'Log out';
                    authButton.classList.remove('link');
                    authButton.classList.add('logout');
                } else {
                    authButton.innerText = 'Link to Google Account';
                    authButton.classList.remove('logout');
                    authButton.classList.add('link');
                }
            });

            // Check authentication status on load
            ipcRenderer.send('check-auth-status');
        });

        function markSelectedColor(calendarId, colorSet) {
            document.querySelectorAll(`.${calendarId}-color-button`).forEach(button => {
                if (button.getAttribute('data-color-set') === colorSet) {
                    button.classList.add('selected');
                } else {
                    button.classList.remove('selected');
                }
            });
        }

        function clearSelectedColor(calendarId) {
            document.querySelectorAll(`.${calendarId}-color-button`).forEach(button => {
                button.classList.remove('selected');
            });
        }

    </script>
</body>

</html>