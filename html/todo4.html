<!DOCTYPE html>
<html>

<head>
    <title>To Do List: Grid</title>
    <link rel="stylesheet" href="../css/cal-color.css">
    <link rel="stylesheet" href="../css/my-widdy.css">


    <style>
        .toDoList-page {
            background-color: #404040;
        }

        #toDoList-page {
            color: #FF8D3A;
            font-weight: bold;
        }

        .todo4-image {
            width: 43.5rem;
            height: 13.9375rem;
        }
    </style>
</head>

<body>

    <div class="sidebar">
        <div class="sidebar-header">
            <!-- <a href="#" target="_blank"> -->
            <img src="../src/logo.png" alt="Logo Image" class="logo-image">
            </a>
            <a href="#" id="logo-word">Widdy</a>
        </div>
        <div class="sidebar-menu">
            <nav>
                <ul>
                    <li class="myWiddy-page"><a href="#" id="myWiddy-page">My Widdy</a></li>
                    <li class="clock-page"><a href="#" id="clock-page">Clock</a></li>
                    <li class="calendar-page"><a href="#" id="calendar-page">Calendar</a></li>
                    <li class="toDoList-page"><a href="#" id="toDoList-page">To Do List</a></li>
                    <li class="weather-page"><a href="#" id="weather-page">Weather</a></li>
                </ul>
            </nav>
        </div>
    </div>
    <div class="main-content">
        <div class="head-container">
            <img src="../src/go-back-button.png" alt="Go Back" class="back-button">
            <div class="name">
                <a>To Do List: Grid</a>
            </div>
        </div>
        <div class="main-container">

            <img src="../src/todo/todo4.png" alt="Todo4 Image" class="todo4-image">

            <div class="setting">

                <div class="switch-container">
                    <a class="off">Off</a>
                    <label class="switch">
                        <input type="checkbox" id="toggleSwitchTodo4">
                        <span class="slider"></span>
                    </label>
                    <a class="on">On</a>
                </div>

                <div class="color-setting">
                    <div class="color-header">Colors</div>
                    <div class="color-tiles">
                        <div class="color-buttons-white">
                            <button class="todo4-color-button" data-color-set="white">
                                <img src="../src/calendar/cal1-white.png" alt="white" width="30px" height="30px">
                            </button>
                            <button class="todo4-color-button" data-color-set="cmyk">
                                <img src="../src/calendar/cal1-cmyk.png" alt="cmyk" width="30px" height="30px">
                            </button>
                            <button class="todo4-color-button" data-color-set="li-pink">
                                <img src="../src/calendar/cal1-li-pink.png" alt="li-pink" width="30px" height="30px">
                            </button>
                            <button class="todo4-color-button" data-color-set="li-orange">
                                <img src="../src/calendar/cal1-li-orange.png" alt="li-orange" width="30px"
                                    height="30px">
                            </button>
                            <button class="todo4-color-button" data-color-set="li-green">
                                <img src="../src/calendar/cal1-li-green.png" alt="li-green" width="30px" height="30px">
                            </button>
                            <button class="todo4-color-button" data-color-set="li-mint">
                                <img src="../src/calendar/cal1-li-mint.png" alt="li-mint" width="30px" height="30px">
                            </button>
                            <button class="todo4-color-button" data-color-set="li-blue">
                                <img src="../src/calendar/cal1-li-blue.png" alt="li-blue" width="30px" height="30px">
                            </button>
                            <button class="todo4-color-button" data-color-set="li-purple">
                                <img src="../src/calendar/cal1-li-purple.png" alt="li-purple" width="30px"
                                    height="30px">
                            </button>
                        </div>
                        <div class="color-buttons-black">
                            <button class="todo4-color-button" data-color-set="black">
                                <img src="../src/calendar/cal1-black.png" alt="Black" width="30px" height="30px">
                            </button>
                            <button class="todo4-color-button" data-color-set="grey">
                                <img src="../src/calendar/cal1-grey.png" alt="grey" width="30px" height="30px">
                            </button>
                            <button class="todo4-color-button" data-color-set="pink">
                                <img src="../src/calendar/cal1-pink.png" alt="pink" width="30px" height="30px">
                            </button>
                            <button class="todo4-color-button" data-color-set="orange">
                                <img src="../src/calendar/cal1-orange.png" alt="orange" width="30px" height="30px">
                            </button>
                            <button class="todo4-color-button" data-color-set="green">
                                <img src="../src/calendar/cal1-green.png" alt="green" width="30px" height="30px">
                            </button>
                            <button class="todo4-color-button" data-color-set="mint">
                                <img src="../src/calendar/cal1-mint.png" alt="mint" width="30px" height="30px">
                            </button>
                            <button class="todo4-color-button" data-color-set="blue">
                                <img src="../src/calendar/cal1-blue.png" alt="blue" width="30px" height="30px">
                            </button>
                            <button class="todo4-color-button" data-color-set="purple">
                                <img src="../src/calendar/cal1-purple.png" alt="purple" width="30px" height="30px">
                            </button>
                        </div>
                    </div>
                </div>
                <div class="todo4-size-setting">
                    <div class="sizeheader">Size</div>
                    <div class="slider-container11">
                        <input type="range" id="sizeSliderTodo4" min="1" max="100" value="50" class="custom-slider">
                        <span id="sliderValueTodo4">50</span>
                    </div>
                </div>
                <button id="auth-button" class="link">Link to Google Account</button>
                <div id="auth-status"></div>
            </div>
        </div>
    </div>


    <script>
        const { ipcRenderer } = require('electron');


        document.getElementById('myWiddy-page').addEventListener('click', () => {
            window.location.href = 'my-widdy.html';
        });

        document.getElementById('logo-word').addEventListener('click', () => {
            window.location.href = 'my-widdy.html';
        });

        document.querySelector('.logo-image').addEventListener('click', (event) => {
            event.preventDefault();
            window.location.href = 'my-widdy.html';
        });

        document.querySelector('.back-button').addEventListener('click', () => {
            window.history.back();
        });

        document.getElementById('clock-page').addEventListener('click', () => {
            window.location.href = 'clock.html';
        });

        document.getElementById('calendar-page').addEventListener('click', () => {
            window.location.href = 'calendar.html';
        });

        document.getElementById('toDoList-page').addEventListener('click', () => {
            window.location.href = 'toDoList.html';
        });

        document.getElementById('weather-page').addEventListener('click', () => {
            window.location.href = 'weather.html';
        });




        // document.addEventListener('DOMContentLoaded', () => {
        //     const toggleSwitchTodo4 = document.getElementById('toggleSwitchTodo4');
        //     const sizeSliderTodo4 = document.getElementById('sizeSliderTodo4');
        //     const sliderValueTodo4 = document.getElementById('sliderValueTodo4');


        //     function synchronizeSettings() {
        //         const isTodo4Open = localStorage.getItem('showTodo4') === 'true';
        //         toggleSwitchTodo4.checked = isTodo4Open;

        //         if (isTodo4Open) {
        //             const cal1Size = localStorage.getItem('cal1Size') || 50;
        //             sizeSliderTodo4.value = cal1Size;
        //             sliderValueTodo4.innerText = cal1Size;
        //             const cal1ColorSet = localStorage.getItem('cal1ColorSet') || 'li-grey';
        //             document.body.className = cal1ColorSet;
        //             document.querySelectorAll('.cal1-color-button').forEach(button => {
        //                 if (button.getAttribute('data-color-set') === cal1ColorSet) {
        //                     button.classList.add('selected');
        //                 } else {
        //                     button.classList.remove('selected');
        //                 }
        //             });
        //         }
        //     }

        //     synchronizeSettings();

        //     toggleSwitchTodo4.addEventListener('change', () => {
        //         const isChecked = toggleSwitchTodo4.checked;
        //         localStorage.setItem('showTodo4', isChecked);
        //         ipcRenderer.send('cal1-status', { status: isChecked });

        //         if (isChecked) {
        //             synchronizeSettings();
        //         } else {
        //             sizeSliderTodo4.value = 50;
        //             sliderValueTodo4.innerText = 50;
        //             document.body.className = '';
        //             document.querySelectorAll('.cal1-color-button').forEach(button => {
        //                 button.classList.remove('selected');
        //             });
        //         }
        //     });

        //     sizeSliderTodo4.addEventListener('input', () => {
        //         const newSize = sizeSliderTodo4.value;
        //         sliderValueTodo4.innerText = newSize;
        //         ipcRenderer.send('adjust-cal1-size', { size: newSize });
        //         localStorage.setItem('cal1Size', newSize);
        //     });

        //     document.querySelectorAll('.cal1-color-button').forEach(button => {
        //         button.addEventListener('click', () => {
        //             const colorSet = button.getAttribute('data-color-set');
        //             localStorage.setItem('cal1ColorSet', colorSet);
        //             ipcRenderer.send('change-cal1-color', colorSet);
        //             document.body.className = colorSet;
        //             document.querySelectorAll('.cal1-color-button').forEach(btn => {
        //                 if (btn.getAttribute('data-color-set') === colorSet) {
        //                     btn.classList.add('selected');
        //                 } else {
        //                     btn.classList.remove('selected');
        //                 }
        //             });
        //         });
        //     });

        //     window.addEventListener('storage', synchronizeSettings);
        // });

        // document.getElementById('auth-button').addEventListener('click', () => {
        //     window.open('http://localhost:3000/auth', '_blank');
        //     const authButton = document.getElementById('auth-button');
        //     const buttonText = authButton.innerText;
        //     if (buttonText === 'Link to Google Account') {
        //         ipcRenderer.send('auth-google');
        //     } else {
        //         ipcRenderer.send('logout-google');
        //     }
        // });

        // ipcRenderer.on('auth-status', (event, status) => {
        //     const authButton = document.getElementById('auth-button');
        //     const authStatus = document.getElementById('auth-status');

        //     if (status === 'linked') {
        //         authButton.innerText = 'Log out';
        //         authButton.classList.remove('link');
        //         authButton.classList.add('logout');
        //     } else {
        //         authButton.innerText = 'Link to Google Account';
        //         authButton.classList.remove('logout');
        //         authButton.classList.add('link');
        //     }
        // });

        // ipcRenderer.send('check-auth-status');


        document.addEventListener('DOMContentLoaded', () => {
            const toggleSwitchTodo4 = document.getElementById('toggleSwitchTodo4');
            const sizeSliderTodo4 = document.getElementById('sizeSliderTodo4');
            const sliderValueTodo4 = document.getElementById('sliderValueTodo4');
            const currentColorSetTodo4 = localStorage.getItem('todo4ColorSet') || 'li-grey';
            const isTodo4Open = localStorage.getItem('showTodo4') === 'true';

            // Initialize the state of the toggle switch
            toggleSwitchTodo4.checked = isTodo4Open;

            // Initialize the size slider and its value display
            sizeSliderTodo4.value = localStorage.getItem('todo4Size') || 50;
            sliderValueTodo4.innerText = sizeSliderTodo4.value;

            // Mark the selected color button
            markSelectedColor('todo4', currentColorSetTodo4);

            // Handle toggle switch change
            toggleSwitchTodo4.addEventListener('change', () => {
                const isChecked = toggleSwitchTodo4.checked;
                localStorage.setItem('showTodo4', isChecked);
                ipcRenderer.send('todo4-status', { status: isChecked });

                if (isChecked) {
                    // Set default settings when turned on
                    localStorage.setItem('todo4ColorSet', 'li-grey');
                    markSelectedColor('todo4', 'li-grey'); // Place color-check on li-grey
                    sizeSliderTodo4.value = 50;
                    sliderValueTodo4.innerText = 50;
                    localStorage.setItem('todo4Size', 50);
                    ipcRenderer.send('adjust-todo4-size', { size: 50 });
                } else {
                    // Reset settings when turned off
                    clearSelectedColor('todo4');
                    sizeSliderTodo4.value = 50;
                    sliderValueTodo4.innerText = 50;
                    ipcRenderer.send('adjust-todo4-size', { size: 50 });
                }
            });

            // Handle color button click
            document.querySelectorAll('.todo4-color-button').forEach(button => {
                button.addEventListener('click', () => {
                    const colorSet = button.getAttribute('data-color-set');
                    localStorage.setItem('todo4ColorSet', colorSet);
                    ipcRenderer.send('change-todo4-color', colorSet);
                    markSelectedColor('todo4', colorSet);
                });
            });

            // Handle size slider input
            sizeSliderTodo4.addEventListener('input', () => {
                const newSize = sizeSliderTodo4.value;
                sliderValueTodo4.innerText = newSize;
                ipcRenderer.send('adjust-todo4-size', { size: newSize });
                localStorage.setItem('todo4Size', newSize);
            });

            // Handle authentication button click
            document.getElementById('auth-button').addEventListener('click', () => {
                const authButton = document.getElementById('auth-button');
                const buttonText = authButton.innerText;
                if (buttonText === 'Link to Google Account') {
                    ipcRenderer.send('auth-google');
                } else {
                    ipcRenderer.send('logout-google');
                }
            });

            // Update authentication status
            ipcRenderer.on('auth-status', (event, status) => {
                const authButton = document.getElementById('auth-button');
                const authStatus = document.getElementById('auth-status');

                if (status === 'linked') {
                    authButton.innerText = 'Log out';
                    authButton.classList.remove('link');
                    authButton.classList.add('logout');
                } else {
                    authButton.innerText = 'Link to Google Account';
                    authButton.classList.remove('logout');
                    authButton.classList.add('link');
                }
            });

            // Check authentication status on load
            ipcRenderer.send('check-auth-status');
        });

        function markSelectedColor(calendarId, colorSet) {
            document.querySelectorAll(`.${calendarId}-color-button`).forEach(button => {
                if (button.getAttribute('data-color-set') === colorSet) {
                    button.classList.add('selected');
                } else {
                    button.classList.remove('selected');
                }
            });
        }

        function clearSelectedColor(calendarId) {
            document.querySelectorAll(`.${calendarId}-color-button`).forEach(button => {
                button.classList.remove('selected');
            });
        }

    </script>
</body>

</html>